04/18/2023 17:25:58 - WARNING - __main__ -   device: cuda:1, n_gpu: 1
Some weights of the model checkpoint at microsoft/graphcodebert-base were not used when initializing RobertaModel: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.bias', 'lm_head.decoder.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaModel were not initialized from the model checkpoint at microsoft/graphcodebert-base and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2023 17:26:00 - INFO - __main__ -   Training/evaluation parameters Namespace(model='devign', hidden_size=768, feature_dim_size=768, num_GNN_layers=2, gnn='ReGCN', format='uni', window_size=3, remove_residual=False, att_op='mul', training_percent=1.0, alpha_weight=1.0, num_classes=1, train_data_file='../../data/processed_train.csv', output_dir='./saved_models', use_logit_adjustment=False, tau=1, use_focal_loss=False, model_type='bert', block_size=512, eval_data_file='../../data/processed_val.csv', test_data_file='../../data/processed_test.csv', model_name='devign_model.bin', model_name_or_path='microsoft/graphcodebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/graphcodebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=True, do_token_level_eval=False, reasoning_method='attention', train_batch_size=128, eval_batch_size=128, gradient_accumulation_steps=1, learning_rate=0.0001, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=100, n_gpu=1, device=device(type='cuda', index=1))
using default unweighted graph
  0%|          | 0/18598 [00:00<?, ?it/s]  0%|          | 71/18598 [00:00<00:26, 705.15it/s]  1%|          | 171/18598 [00:00<00:21, 868.64it/s]  1%|▏         | 258/18598 [00:00<00:27, 666.74it/s]  2%|▏         | 329/18598 [00:00<00:28, 632.26it/s]  2%|▏         | 397/18598 [00:00<00:28, 642.39it/s]  3%|▎         | 471/18598 [00:00<00:27, 670.74it/s]  3%|▎         | 558/18598 [00:00<00:24, 729.77it/s]  4%|▎         | 667/18598 [00:00<00:21, 836.87it/s]  4%|▍         | 770/18598 [00:00<00:19, 894.01it/s]  5%|▍         | 876/18598 [00:01<00:18, 943.05it/s]  5%|▌         | 972/18598 [00:01<00:19, 910.80it/s]  6%|▌         | 1065/18598 [00:01<00:21, 813.21it/s]  6%|▋         | 1163/18598 [00:01<00:20, 857.44it/s]  7%|▋         | 1253/18598 [00:01<00:19, 868.12it/s]  7%|▋         | 1342/18598 [00:01<00:21, 801.76it/s]  8%|▊         | 1432/18598 [00:01<00:20, 826.99it/s]  8%|▊         | 1517/18598 [00:01<00:20, 819.79it/s]  9%|▉         | 1635/18598 [00:01<00:18, 920.08it/s]  9%|▉         | 1735/18598 [00:02<00:17, 940.31it/s] 10%|▉         | 1840/18598 [00:02<00:17, 970.41it/s] 10%|█         | 1938/18598 [00:02<00:18, 889.03it/s] 11%|█         | 2042/18598 [00:02<00:17, 930.54it/s] 12%|█▏        | 2139/18598 [00:02<00:17, 939.39it/s] 12%|█▏        | 2267/18598 [00:02<00:15, 1037.21it/s] 13%|█▎        | 2382/18598 [00:02<00:15, 1067.63it/s] 13%|█▎        | 2490/18598 [00:02<00:15, 1042.37it/s] 14%|█▍        | 2616/18598 [00:02<00:14, 1103.43it/s] 15%|█▍        | 2759/18598 [00:03<00:13, 1198.76it/s] 15%|█▌        | 2880/18598 [00:03<00:13, 1146.98it/s] 16%|█▌        | 3001/18598 [00:03<00:13, 1163.47it/s] 17%|█▋        | 3119/18598 [00:03<00:14, 1040.20it/s] 17%|█▋        | 3226/18598 [00:03<00:15, 1008.86it/s] 18%|█▊        | 3329/18598 [00:03<00:17, 887.39it/s]  18%|█▊        | 3422/18598 [00:03<00:17, 850.99it/s] 19%|█▉        | 3510/18598 [00:03<00:17, 857.63it/s] 20%|█▉        | 3627/18598 [00:03<00:15, 940.36it/s] 20%|██        | 3724/18598 [00:04<00:16, 905.64it/s] 21%|██        | 3848/18598 [00:04<00:18, 777.03it/s] 21%|██        | 3931/18598 [00:04<00:20, 715.24it/s] 22%|██▏       | 4007/18598 [00:04<00:20, 708.56it/s] 22%|██▏       | 4104/18598 [00:04<00:18, 771.72it/s] 23%|██▎       | 4199/18598 [00:04<00:17, 817.19it/s] 23%|██▎       | 4284/18598 [00:04<00:18, 784.52it/s] 24%|██▎       | 4382/18598 [00:04<00:17, 827.00it/s] 24%|██▍       | 4492/18598 [00:05<00:15, 900.91it/s] 25%|██▍       | 4611/18598 [00:05<00:14, 977.51it/s] 25%|██▌       | 4711/18598 [00:05<00:14, 970.57it/s] 26%|██▌       | 4823/18598 [00:05<00:13, 1012.49it/s] 26%|██▋       | 4926/18598 [00:05<00:13, 991.10it/s]  27%|██▋       | 5041/18598 [00:05<00:13, 1027.59it/s] 28%|██▊       | 5165/18598 [00:05<00:12, 1088.17it/s] 28%|██▊       | 5275/18598 [00:05<00:12, 1072.70it/s] 29%|██▉       | 5383/18598 [00:05<00:12, 1024.12it/s] 30%|██▉       | 5487/18598 [00:06<00:14, 925.73it/s]  30%|███       | 5602/18598 [00:06<00:13, 985.59it/s] 31%|███       | 5703/18598 [00:06<00:13, 948.18it/s] 31%|███       | 5801/18598 [00:06<00:13, 952.51it/s] 32%|███▏      | 5909/18598 [00:06<00:12, 986.94it/s] 32%|███▏      | 6009/18598 [00:06<00:13, 962.18it/s] 33%|███▎      | 6106/18598 [00:06<00:13, 915.43it/s] 33%|███▎      | 6203/18598 [00:06<00:13, 920.86it/s] 34%|███▍      | 6304/18598 [00:06<00:13, 945.41it/s] 34%|███▍      | 6404/18598 [00:07<00:12, 961.03it/s] 35%|███▍      | 6503/18598 [00:07<00:12, 969.19it/s] 36%|███▌      | 6617/18598 [00:07<00:11, 1017.21it/s] 36%|███▌      | 6725/18598 [00:07<00:11, 1034.69it/s] 37%|███▋      | 6846/18598 [00:07<00:10, 1086.16it/s] 37%|███▋      | 6955/18598 [00:07<00:10, 1077.04it/s] 38%|███▊      | 7063/18598 [00:07<00:11, 1013.89it/s] 39%|███▊      | 7181/18598 [00:07<00:10, 1055.82it/s] 39%|███▉      | 7288/18598 [00:07<00:11, 959.11it/s]  40%|███▉      | 7408/18598 [00:07<00:10, 1020.82it/s] 40%|████      | 7513/18598 [00:08<00:10, 1016.29it/s] 41%|████      | 7621/18598 [00:08<00:10, 1026.58it/s] 42%|████▏     | 7725/18598 [00:08<00:11, 951.53it/s]  42%|████▏     | 7827/18598 [00:08<00:11, 970.26it/s] 43%|████▎     | 7926/18598 [00:08<00:11, 968.04it/s] 43%|████▎     | 8030/18598 [00:08<00:10, 986.12it/s] 44%|████▎     | 8132/18598 [00:08<00:10, 994.27it/s] 44%|████▍     | 8238/18598 [00:08<00:10, 1012.86it/s] 45%|████▍     | 8340/18598 [00:08<00:10, 995.01it/s]  45%|████▌     | 8447/18598 [00:09<00:09, 1016.80it/s] 46%|████▌     | 8549/18598 [00:09<00:10, 973.73it/s]  47%|████▋     | 8670/18598 [00:09<00:09, 1039.55it/s] 47%|████▋     | 8782/18598 [00:09<00:09, 1056.57it/s] 48%|████▊     | 8889/18598 [00:09<00:09, 1029.04it/s] 48%|████▊     | 8993/18598 [00:09<00:09, 1000.43it/s] 49%|████▉     | 9102/18598 [00:09<00:09, 1025.96it/s] 50%|████▉     | 9217/18598 [00:09<00:08, 1061.65it/s] 50%|█████     | 9324/18598 [00:09<00:08, 1056.18it/s] 51%|█████     | 9430/18598 [00:09<00:08, 1054.63it/s] 51%|█████▏    | 9536/18598 [00:10<00:09, 972.93it/s]  52%|█████▏    | 9640/18598 [00:10<00:09, 984.02it/s] 52%|█████▏    | 9745/18598 [00:10<00:08, 1002.55it/s] 53%|█████▎    | 9852/18598 [00:10<00:08, 1013.18it/s] 54%|█████▎    | 9971/18598 [00:10<00:08, 1056.23it/s] 54%|█████▍    | 10078/18598 [00:10<00:09, 942.83it/s] 55%|█████▍    | 10175/18598 [00:10<00:08, 941.19it/s] 55%|█████▌    | 10297/18598 [00:10<00:08, 1017.29it/s] 56%|█████▌    | 10401/18598 [00:10<00:08, 996.09it/s]  57%|█████▋    | 10532/18598 [00:11<00:07, 1084.29it/s] 57%|█████▋    | 10642/18598 [00:11<00:07, 1084.45it/s] 58%|█████▊    | 10759/18598 [00:11<00:07, 1108.59it/s] 58%|█████▊    | 10871/18598 [00:11<00:07, 1067.12it/s] 59%|█████▉    | 10988/18598 [00:11<00:06, 1094.70it/s] 60%|█████▉    | 11099/18598 [00:11<00:07, 1013.87it/s] 60%|██████    | 11203/18598 [00:11<00:07, 1019.79it/s] 61%|██████    | 11309/18598 [00:11<00:07, 1026.10it/s] 61%|██████▏   | 11420/18598 [00:11<00:06, 1049.88it/s] 62%|██████▏   | 11526/18598 [00:12<00:06, 1017.14it/s] 63%|██████▎   | 11643/18598 [00:12<00:06, 1030.19it/s] 63%|██████▎   | 11750/18598 [00:12<00:06, 1041.38it/s] 64%|██████▍   | 11869/18598 [00:12<00:06, 1082.57it/s] 64%|██████▍   | 11978/18598 [00:12<00:06, 997.21it/s]  65%|██████▍   | 12080/18598 [00:12<00:06, 970.91it/s] 65%|██████▌   | 12179/18598 [00:12<00:07, 910.41it/s] 66%|██████▌   | 12301/18598 [00:12<00:06, 992.79it/s] 67%|██████▋   | 12428/18598 [00:12<00:05, 1069.61it/s] 67%|██████▋   | 12543/18598 [00:13<00:05, 1091.56it/s] 68%|██████▊   | 12655/18598 [00:13<00:05, 1098.69it/s] 69%|██████▊   | 12766/18598 [00:13<00:05, 1066.94it/s] 69%|██████▉   | 12886/18598 [00:13<00:05, 1101.61it/s] 70%|██████▉   | 12997/18598 [00:13<00:05, 1076.01it/s] 71%|███████   | 13113/18598 [00:13<00:05, 1096.97it/s] 71%|███████▏  | 13268/18598 [00:13<00:04, 1226.45it/s] 72%|███████▏  | 13392/18598 [00:13<00:04, 1059.61it/s] 73%|███████▎  | 13503/18598 [00:13<00:05, 1012.99it/s] 73%|███████▎  | 13608/18598 [00:14<00:04, 1018.12it/s] 74%|███████▎  | 13713/18598 [00:14<00:05, 900.42it/s]  74%|███████▍  | 13830/18598 [00:14<00:04, 960.89it/s] 75%|███████▌  | 13963/18598 [00:14<00:04, 1057.96it/s] 76%|███████▌  | 14073/18598 [00:14<00:04, 1058.56it/s] 76%|███████▋  | 14184/18598 [00:14<00:04, 1072.06it/s] 77%|███████▋  | 14294/18598 [00:14<00:04, 909.21it/s]  77%|███████▋  | 14391/18598 [00:14<00:04, 910.19it/s] 78%|███████▊  | 14495/18598 [00:14<00:04, 940.68it/s] 79%|███████▊  | 14603/18598 [00:15<00:04, 975.07it/s] 79%|███████▉  | 14703/18598 [00:15<00:04, 968.60it/s] 80%|███████▉  | 14840/18598 [00:15<00:03, 1079.67it/s] 80%|████████  | 14950/18598 [00:15<00:04, 883.78it/s]  81%|████████  | 15066/18598 [00:15<00:03, 950.23it/s] 82%|████████▏ | 15178/18598 [00:15<00:03, 986.72it/s] 82%|████████▏ | 15282/18598 [00:15<00:03, 972.07it/s] 83%|████████▎ | 15405/18598 [00:15<00:03, 1040.36it/s] 83%|████████▎ | 15519/18598 [00:15<00:02, 1061.81it/s] 84%|████████▍ | 15643/18598 [00:16<00:02, 1104.39it/s] 85%|████████▍ | 15756/18598 [00:16<00:02, 1043.04it/s] 85%|████████▌ | 15863/18598 [00:16<00:02, 1044.39it/s] 86%|████████▌ | 15973/18598 [00:16<00:02, 1059.66it/s] 87%|████████▋ | 16096/18598 [00:16<00:02, 1108.49it/s] 87%|████████▋ | 16208/18598 [00:16<00:02, 1099.52it/s] 88%|████████▊ | 16319/18598 [00:16<00:02, 1090.61it/s] 88%|████████▊ | 16438/18598 [00:16<00:01, 1105.75it/s] 89%|████████▉ | 16549/18598 [00:16<00:02, 986.00it/s]  90%|████████▉ | 16651/18598 [00:17<00:02, 901.87it/s] 90%|█████████ | 16799/18598 [00:17<00:01, 1048.79it/s] 91%|█████████ | 16908/18598 [00:17<00:01, 1025.98it/s] 92%|█████████▏| 17022/18598 [00:17<00:01, 1054.08it/s] 92%|█████████▏| 17154/18598 [00:17<00:01, 1121.98it/s] 93%|█████████▎| 17269/18598 [00:17<00:01, 1124.43it/s] 93%|█████████▎| 17383/18598 [00:17<00:01, 1042.18it/s] 94%|█████████▍| 17492/18598 [00:17<00:01, 1053.08it/s] 95%|█████████▍| 17621/18598 [00:17<00:00, 1114.93it/s] 95%|█████████▌| 17759/18598 [00:18<00:00, 1187.11it/s] 96%|█████████▌| 17881/18598 [00:18<00:00, 1188.79it/s] 97%|█████████▋| 18001/18598 [00:18<00:00, 1154.20it/s] 97%|█████████▋| 18121/18598 [00:18<00:00, 1166.52it/s] 98%|█████████▊| 18242/18598 [00:18<00:00, 1172.69it/s] 99%|█████████▊| 18365/18598 [00:18<00:00, 1182.15it/s] 99%|█████████▉| 18484/18598 [00:18<00:00, 1142.90it/s]100%|██████████| 18598/18598 [00:18<00:00, 992.09it/s] 
04/18/2023 17:26:20 - INFO - __main__ -   ***** Running evaluation *****
04/18/2023 17:26:20 - INFO - __main__ -     Num examples = 18598
04/18/2023 17:26:20 - INFO - __main__ -     Batch size = 128
04/18/2023 17:30:30 - INFO - __main__ -   ***** Test results *****
04/18/2023 17:30:30 - INFO - __main__ -     test_acc = 0.969
04/18/2023 17:30:30 - INFO - __main__ -     test_f1 = 0.5928
04/18/2023 17:30:30 - INFO - __main__ -     test_precision = 0.7229
04/18/2023 17:30:30 - INFO - __main__ -     test_recall = 0.5024
